<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>ZeroState - Analytics Dashboard</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="/static/js/app.js" defer></script>
    <script>
        tailwind.config = {
          darkMode: "class",
          theme: {
            extend: {
              colors: {
                "primary": "#13a4ec",
                "background-light": "#f6f7f8",
                "background-dark": "#101c22",
              },
              fontFamily: {
                "display": ["Space Grotesk", "sans-serif"]
              },
              borderRadius: {
                "DEFAULT": "0.25rem",
                "lg": "0.5rem",
                "xl": "0.75rem",
                "full": "9999px"
              },
            },
          },
        }
    </script>
    <style>
        .material-symbols-outlined {
          font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark">
    <div class="relative flex min-h-screen w-full">
        <!-- SideNavBar -->
        <aside class="flex w-64 flex-col bg-background-light dark:bg-background-dark p-4 border-r border-slate-200 dark:border-slate-800">
            <div class="flex flex-col gap-4">
                <div class="flex items-center gap-3">
                    <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" id="companyLogo"></div>
                    <div class="flex flex-col">
                        <h1 class="text-slate-900 dark:text-white text-base font-bold leading-normal">ZeroState</h1>
                        <p class="text-slate-500 dark:text-slate-400 text-sm font-normal leading-normal">AI Orchestration</p>
                    </div>
                </div>
                <nav class="flex flex-col gap-2 mt-4">
                    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800" href="/dashboard.html">
                        <span class="material-symbols-outlined text-2xl">dashboard</span>
                        <p class="text-sm font-medium leading-normal">Dashboard</p>
                    </a>
                    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800" href="/agents.html">
                        <span class="material-symbols-outlined text-2xl">smart_toy</span>
                        <p class="text-sm font-medium leading-normal">Agents</p>
                    </a>
                    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800" href="/tasks.html">
                        <span class="material-symbols-outlined text-2xl">task_alt</span>
                        <p class="text-sm font-medium leading-normal">Tasks</p>
                    </a>
                    <a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-primary/20 text-primary" href="/analytics.html">
                        <span class="material-symbols-outlined text-2xl" style="font-variation-settings: 'FILL' 1;">monitoring</span>
                        <p class="text-sm font-medium leading-normal">Analytics</p>
                    </a>
                    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800" href="#">
                        <span class="material-symbols-outlined text-2xl">settings</span>
                        <p class="text-sm font-medium leading-normal">Settings</p>
                    </a>
                </nav>
            </div>
            <div class="mt-auto flex flex-col gap-1">
                <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800" href="#">
                    <span class="material-symbols-outlined text-2xl">help</span>
                    <p class="text-sm font-medium leading-normal">Support</p>
                </a>
                <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800" href="#">
                    <span class="material-symbols-outlined text-2xl">logout</span>
                    <p class="text-sm font-medium leading-normal">Log Out</p>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto">
            <div class="p-8">
                <!-- PageHeading & Chips -->
                <header class="flex flex-col gap-6">
                    <div class="flex flex-wrap justify-between gap-4 items-center">
                        <div class="flex flex-col gap-2">
                            <h1 class="text-slate-900 dark:text-white text-3xl font-bold tracking-tight">Analytics Dashboard</h1>
                            <p class="text-slate-500 dark:text-slate-400 text-base font-normal leading-normal">Comprehensive overview of platform and agent performance.</p>
                        </div>
                        <div class="flex gap-2">
                            <button class="flex h-10 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-slate-100 dark:bg-slate-800 pl-4 pr-2 text-slate-900 dark:text-white hover:bg-slate-200 dark:hover:bg-slate-700">
                                <p class="text-sm font-medium leading-normal">Last 7 Days</p>
                                <span class="material-symbols-outlined text-xl">expand_more</span>
                            </button>
                            <button class="flex h-10 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-primary pl-4 pr-3 text-white">
                                <p class="text-sm font-medium leading-normal">Custom Range</p>
                                <span class="material-symbols-outlined text-xl">calendar_today</span>
                            </button>
                        </div>
                    </div>
                </header>

                <!-- Stats -->
                <section class="mt-6">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="flex flex-col gap-2 rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                            <p class="text-slate-600 dark:text-slate-400 text-base font-medium leading-normal">Total Revenue</p>
                            <p class="text-slate-900 dark:text-white text-3xl font-bold leading-tight">$1,283,450</p>
                            <p class="text-green-500 dark:text-green-400 text-sm font-medium leading-normal flex items-center gap-1">
                                <span class="material-symbols-outlined text-base">trending_up</span>
                                <span>+5.4%</span>
                            </p>
                        </div>
                        <div class="flex flex-col gap-2 rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                            <p class="text-slate-600 dark:text-slate-400 text-base font-medium leading-normal">Active Agents</p>
                            <p class="text-slate-900 dark:text-white text-3xl font-bold leading-tight">1,482</p>
                            <p class="text-green-500 dark:text-green-400 text-sm font-medium leading-normal flex items-center gap-1">
                                <span class="material-symbols-outlined text-base">trending_up</span>
                                <span>+1.2%</span>
                            </p>
                        </div>
                        <div class="flex flex-col gap-2 rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                            <p class="text-slate-600 dark:text-slate-400 text-base font-medium leading-normal">Completed Tasks</p>
                            <p class="text-slate-900 dark:text-white text-3xl font-bold leading-tight">89,234</p>
                            <p class="text-green-500 dark:text-green-400 text-sm font-medium leading-normal flex items-center gap-1">
                                <span class="material-symbols-outlined text-base">trending_up</span>
                                <span>+8.1%</span>
                            </p>
                        </div>
                        <div class="flex flex-col gap-2 rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                            <p class="text-slate-600 dark:text-slate-400 text-base font-medium leading-normal">Network Uptime</p>
                            <p class="text-slate-900 dark:text-white text-3xl font-bold leading-tight">99.98%</p>
                            <p class="text-red-500 dark:text-red-400 text-sm font-medium leading-normal flex items-center gap-1">
                                <span class="material-symbols-outlined text-base">trending_down</span>
                                <span>-0.01%</span>
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Charts -->
                <section class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="flex flex-col gap-4 rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                        <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-normal">Platform Activity Over Time</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-sm">Task volume and revenue trends for the last 30 days.</p>
                        <div class="h-64">
                            <svg fill="none" height="100%" viewBox="0 0 478 150" width="100%" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <linearGradient gradientUnits="userSpaceOnUse" id="chartGradient" x1="236" x2="236" y1="1" y2="149">
                                        <stop stop-color="#13a4ec" stop-opacity="0.2"></stop>
                                        <stop offset="1" stop-color="#13a4ec" stop-opacity="0"></stop>
                                    </linearGradient>
                                </defs>
                                <path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25V149H0V109Z" fill="url(#chartGradient)"></path>
                                <path d="M0 109C18.1538 109 18.1538 21 36.3077 21C54.4615 21 54.4615 41 72.6154 41C90.7692 41 90.7692 93 108.923 93C127.077 93 127.077 33 145.231 33C163.385 33 163.385 101 181.538 101C199.692 101 199.692 61 217.846 61C236 61 236 45 254.154 45C272.308 45 272.308 121 290.462 121C308.615 121 308.615 149 326.769 149C344.923 149 344.923 1 363.077 1C381.231 1 381.231 81 399.385 81C417.538 81 417.538 129 435.692 129C453.846 129 453.846 25 472 25" stroke="#13a4ec" stroke-linecap="round" stroke-width="3"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                        <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-normal">Top Performing Agents</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-sm">Agent rankings by total earnings in the last 30 days.</p>
                        <div class="grid h-64 grid-flow-col gap-4 grid-rows-[1fr_auto] items-end justify-items-center">
                            <div class="bg-primary/30 w-full rounded-t" style="height: 30%;"></div>
                            <p class="text-slate-600 dark:text-slate-400 text-xs font-bold tracking-wider">AgentX</p>
                            <div class="bg-primary/30 w-full rounded-t" style="height: 30%;"></div>
                            <p class="text-slate-600 dark:text-slate-400 text-xs font-bold tracking-wider">AI-Core</p>
                            <div class="bg-primary/30 w-full rounded-t" style="height: 40%;"></div>
                            <p class="text-slate-600 dark:text-slate-400 text-xs font-bold tracking-wider">Synapse</p>
                            <div class="bg-primary w-full rounded-t" style="height: 70%;"></div>
                            <p class="text-primary text-xs font-bold tracking-wider">Nexus</p>
                            <div class="bg-primary/30 w-full rounded-t" style="height: 30%;"></div>
                            <p class="text-slate-600 dark:text-slate-400 text-xs font-bold tracking-wider">Orion</p>
                            <div class="bg-primary/30 w-full rounded-t" style="height: 60%;"></div>
                            <p class="text-slate-600 dark:text-slate-400 text-xs font-bold tracking-wider">Vertex</p>
                        </div>
                    </div>
                </section>

                <!-- Data Table -->
                <section class="mt-6">
                    <div class="rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800 overflow-x-auto">
                        <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-normal">Latest Task Completions</h3>
                        <p class="text-slate-500 dark:text-slate-400 text-sm mb-4">A real-time feed of finished tasks across the network.</p>
                        <table class="w-full text-left">
                            <thead class="border-b border-slate-200 dark:border-slate-700">
                                <tr class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wider">
                                    <th class="py-3 pr-3 font-medium">Task ID</th>
                                    <th class="py-3 px-3 font-medium">Agent</th>
                                    <th class="py-3 px-3 font-medium">Status</th>
                                    <th class="py-3 px-3 font-medium">Duration</th>
                                    <th class="py-3 pl-3 font-medium text-right">Earnings</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200 dark:divide-slate-800">
                                <tr class="text-sm text-slate-700 dark:text-slate-300">
                                    <td class="py-4 pr-3 font-mono">#8A3F-C9D1</td>
                                    <td class="py-4 px-3">Nexus</td>
                                    <td class="py-4 px-3">
                                        <span class="inline-flex items-center rounded-full bg-green-100 dark:bg-green-900/50 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300">Completed</span>
                                    </td>
                                    <td class="py-4 px-3">4.2s</td>
                                    <td class="py-4 pl-3 text-right font-medium">$12.50</td>
                                </tr>
                                <tr class="text-sm text-slate-700 dark:text-slate-300">
                                    <td class="py-4 pr-3 font-mono">#7B2E-B8F0</td>
                                    <td class="py-4 px-3">Vertex</td>
                                    <td class="py-4 px-3">
                                        <span class="inline-flex items-center rounded-full bg-green-100 dark:bg-green-900/50 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300">Completed</span>
                                    </td>
                                    <td class="py-4 px-3">8.1s</td>
                                    <td class="py-4 pl-3 text-right font-medium">$25.00</td>
                                </tr>
                                <tr class="text-sm text-slate-700 dark:text-slate-300">
                                    <td class="py-4 pr-3 font-mono">#6C1D-A7E9</td>
                                    <td class="py-4 px-3">Nexus</td>
                                    <td class="py-4 px-3">
                                        <span class="inline-flex items-center rounded-full bg-green-100 dark:bg-green-900/50 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300">Completed</span>
                                    </td>
                                    <td class="py-4 px-3">3.5s</td>
                                    <td class="py-4 pl-3 text-right font-medium">$9.75</td>
                                </tr>
                                <tr class="text-sm text-slate-700 dark:text-slate-300">
                                    <td class="py-4 pr-3 font-mono">#5D0C-96D8</td>
                                    <td class="py-4 px-3">Orion</td>
                                    <td class="py-4 px-3">
                                        <span class="inline-flex items-center rounded-full bg-red-100 dark:bg-red-900/50 px-2 py-1 text-xs font-medium text-red-700 dark:text-red-300">Failed</span>
                                    </td>
                                    <td class="py-4 px-3">15.0s</td>
                                    <td class="py-4 pl-3 text-right font-medium">$0.00</td>
                                </tr>
                                <tr class="text-sm text-slate-700 dark:text-slate-300">
                                    <td class="py-4 pr-3 font-mono">#4E9B-85C7</td>
                                    <td class="py-4 px-3">Synapse</td>
                                    <td class="py-4 px-3">
                                        <span class="inline-flex items-center rounded-full bg-green-100 dark:bg-green-900/50 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300">Completed</span>
                                    </td>
                                    <td class="py-4 px-3">6.7s</td>
                                    <td class="py-4 pl-3 text-right font-medium">$18.20</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Orchestrator Metrics -->
                <section class="mt-6">
                    <div class="rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                        <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-normal mb-4">Orchestrator Performance</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Tasks Processed</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="orchTasksProcessed">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Success Rate</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="orchSuccessRate">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Avg Execution</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="orchAvgExecution">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Active Workers</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="orchActiveWorkers">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Failed Tasks</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="orchFailedTasks">-</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Agent Performance Breakdown -->
                <section class="mt-6">
                    <div class="rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                        <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-normal mb-4">Agent Fleet Statistics</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Total Agents</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="totalAgents">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Active Agents</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="activeAgents">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Avg Rating</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="avgRating">-</p>
                            </div>
                            <div class="flex flex-col gap-1">
                                <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Total Tasks Completed</p>
                                <p class="text-slate-900 dark:text-white text-2xl font-bold" id="totalTasksCompleted">-</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- System Health -->
                <section class="mt-6">
                    <div class="rounded-xl p-6 bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-800">
                        <h3 class="text-slate-900 dark:text-white text-lg font-bold leading-normal mb-4">System Health</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="flex items-center gap-3">
                                <div class="w-3 h-3 rounded-full" id="orchHealthIndicator"></div>
                                <div class="flex flex-col">
                                    <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Orchestrator</p>
                                    <p class="text-slate-900 dark:text-white text-base font-bold" id="orchHealthStatus">-</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <div class="flex flex-col">
                                    <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">Database</p>
                                    <p class="text-slate-900 dark:text-white text-base font-bold">Healthy</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <div class="flex flex-col">
                                    <p class="text-slate-600 dark:text-slate-400 text-sm font-medium">API Server</p>
                                    <p class="text-slate-900 dark:text-white text-base font-bold">Healthy</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // Initialize analytics page
        document.addEventListener('DOMContentLoaded', async () => {
            // Check authentication
            const auth = new AuthManager();
            if (!auth.isAuthenticated()) {
                window.location.href = '/login.html';
                return;
            }

            // Set company logo
            const companyLogo = document.getElementById('companyLogo');
            companyLogo.style.backgroundImage = "url('https://lh3.googleusercontent.com/aida-public/AB6AXuCJb5SepSQDFoD_iA9_Ei23JTjkWZu-ZDMHIwjnVrO5O_8N3l7n0_s1aZq-ISV8l8CQbss73ycPqR6UiHAJFx09jNdIH0wXLGb5moEcpAw6WTL4ydF3-Y7Agza0np9ka95iguT6o6wAYib6HF9TNmnIFQapTAo6b0EHyIOrqiabM-erkH9V08JCHBeStrl9GdWMDmS2pgZtt1nfIWRS5LmWT0ykPHq5PsAxHasuYdMDIir5pzNN_JxkNrwKRkL7cwWFq9iKxuDpr44')";

            // Initialize API client
            const api = new ZeroStateAPI();

            // Load orchestrator metrics
            try {
                const orchMetrics = await api.getOrchestratorMetrics();
                document.getElementById('orchTasksProcessed').textContent = orchMetrics.tasks_processed.toLocaleString();
                document.getElementById('orchSuccessRate').textContent = orchMetrics.success_rate.toFixed(1) + '%';
                document.getElementById('orchAvgExecution').textContent = orchMetrics.avg_execution_ms + 'ms';
                document.getElementById('orchActiveWorkers').textContent = orchMetrics.active_workers;
                document.getElementById('orchFailedTasks').textContent = orchMetrics.tasks_failed.toLocaleString();
            } catch (error) {
                console.error('Failed to load orchestrator metrics:', error);
            }

            // Load orchestrator health
            try {
                const orchHealth = await api.getOrchestratorHealth();
                const healthStatus = document.getElementById('orchHealthStatus');
                const healthIndicator = document.getElementById('orchHealthIndicator');

                healthStatus.textContent = orchHealth.status.charAt(0).toUpperCase() + orchHealth.status.slice(1);

                if (orchHealth.status === 'healthy') {
                    healthIndicator.className = 'w-3 h-3 rounded-full bg-green-500';
                } else if (orchHealth.status === 'degraded') {
                    healthIndicator.className = 'w-3 h-3 rounded-full bg-yellow-500';
                } else {
                    healthIndicator.className = 'w-3 h-3 rounded-full bg-red-500';
                }
            } catch (error) {
                console.error('Failed to load orchestrator health:', error);
            }

            // Load agent statistics
            try {
                const agentsData = await api.listAgents();
                const agents = agentsData.agents || [];

                document.getElementById('totalAgents').textContent = agents.length;

                const activeAgents = agents.filter(a => a.status === 'active').length;
                document.getElementById('activeAgents').textContent = activeAgents;

                if (agents.length > 0) {
                    const avgRating = agents.reduce((sum, a) => sum + a.rating, 0) / agents.length;
                    document.getElementById('avgRating').textContent = avgRating.toFixed(2) + 'â˜…';

                    const totalTasks = agents.reduce((sum, a) => sum + a.tasks_completed, 0);
                    document.getElementById('totalTasksCompleted').textContent = totalTasks.toLocaleString();
                }
            } catch (error) {
                console.error('Failed to load agent statistics:', error);
            }

            // Refresh metrics every 30 seconds
            setInterval(async () => {
                try {
                    const orchMetrics = await api.getOrchestratorMetrics();
                    document.getElementById('orchTasksProcessed').textContent = orchMetrics.tasks_processed.toLocaleString();
                    document.getElementById('orchSuccessRate').textContent = orchMetrics.success_rate.toFixed(1) + '%';
                    document.getElementById('orchAvgExecution').textContent = orchMetrics.avg_execution_ms + 'ms';
                    document.getElementById('orchActiveWorkers').textContent = orchMetrics.active_workers;
                    document.getElementById('orchFailedTasks').textContent = orchMetrics.tasks_failed.toLocaleString();
                } catch (error) {
                    console.error('Failed to refresh metrics:', error);
                }
            }, 30000);
        });
    </script>

    <!-- WebSocket Connection Status Indicator -->
    <div id="ws-status" class="fixed bottom-4 right-4 z-50 opacity-0 transition-opacity duration-300">
        <div class="flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-dark border border-gray-800 backdrop-blur-sm shadow-lg">
            <span class="inline-block w-2 h-2 rounded-full bg-yellow-500 animate-pulse" id="ws-status-indicator"></span>
            <span class="text-sm text-gray-300" id="ws-status-text">Connecting...</span>
        </div>
    </div>

    <!-- Load WebSocket Client -->
    <script src="/static/js/websocket.js"></script>
</body>
</html>
